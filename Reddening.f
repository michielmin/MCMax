	module ISMExtinction
	IMPLICIT NONE
	integer NLAMISM,i
	parameter(NLAMISM= 1064)
	real*8 lamism(NLAMISM),Kextism(NLAMISM)
 
	data (lamism(i),i=1, 1064) / 
     & 0.10000E-03,0.10233E-03,0.10471E-03,0.10715E-03,0.10965E-03,0.11220E-03,0.11482E-03 
     & ,0.11749E-03,0.12023E-03,0.12303E-03,0.12589E-03,0.12883E-03,0.13183E-03,0.13490E-03 
     & ,0.13804E-03,0.14125E-03,0.14454E-03,0.14791E-03,0.15136E-03,0.15488E-03,0.15849E-03 
     & ,0.16218E-03,0.16596E-03,0.16982E-03,0.17353E-03,0.17365E-03,0.17377E-03,0.17378E-03 
     & ,0.17389E-03,0.17391E-03,0.17394E-03,0.17396E-03,0.17399E-03,0.17401E-03,0.17404E-03 
     & ,0.17406E-03,0.17409E-03,0.17411E-03,0.17414E-03,0.17416E-03,0.17418E-03,0.17421E-03 
     & ,0.17426E-03,0.17438E-03,0.17463E-03,0.17783E-03,0.18197E-03,0.18621E-03,0.19055E-03 
     & ,0.19498E-03,0.19953E-03,0.20417E-03,0.20893E-03,0.21380E-03,0.21878E-03,0.22387E-03 
     & ,0.22909E-03,0.23442E-03,0.23988E-03,0.24547E-03,0.25119E-03,0.25704E-03,0.26303E-03 
     & ,0.26915E-03,0.27542E-03,0.28184E-03,0.28840E-03,0.29512E-03,0.30199E-03,0.30903E-03 
     & ,0.31623E-03,0.32359E-03,0.33113E-03,0.33884E-03,0.34674E-03,0.35481E-03,0.36308E-03 
     & ,0.37153E-03,0.38019E-03,0.38905E-03,0.39811E-03,0.40738E-03,0.41687E-03,0.42658E-03 
     & ,0.43652E-03,0.44668E-03,0.45709E-03,0.46773E-03,0.47863E-03,0.48978E-03,0.50119E-03 
     & ,0.51286E-03,0.52481E-03,0.53703E-03,0.54954E-03,0.56234E-03,0.57544E-03,0.58884E-03 
     & ,0.60256E-03,0.61659E-03,0.63096E-03,0.64565E-03,0.66069E-03,0.66302E-03,0.66408E-03 
     & ,0.66479E-03,0.66586E-03,0.66658E-03,0.66766E-03,0.66838E-03,0.66910E-03,0.66946E-03 
     & ,0.66982E-03,0.67018E-03,0.67055E-03,0.67091E-03,0.67127E-03,0.67145E-03,0.67164E-03 
     & ,0.67171E-03,0.67178E-03,0.67185E-03,0.67193E-03,0.67200E-03,0.67218E-03,0.67273E-03 
     & ,0.67273E-03,0.67309E-03,0.67346E-03,0.67383E-03,0.67608E-03,0.69183E-03,0.70795E-03 
     & ,0.72444E-03,0.74131E-03,0.75858E-03,0.77625E-03,0.79433E-03,0.81283E-03,0.83176E-03 
     & ,0.85114E-03,0.87096E-03,0.89125E-03,0.91201E-03,0.93221E-03,0.93325E-03,0.93661E-03 
     & ,0.93502E-03,0.93644E-03,0.93785E-03,0.93927E-03,0.93998E-03,0.94070E-03,0.94141E-03 
     & ,0.94213E-03,0.94284E-03,0.94356E-03,0.94428E-03,0.94500E-03,0.94536E-03,0.94572E-03 
     & ,0.94587E-03,0.94601E-03,0.94615E-03,0.94644E-03,0.94680E-03,0.94717E-03,0.94789E-03 
     & ,0.94862E-03,0.94934E-03,0.95007E-03,0.95499E-03,0.97724E-03,0.10000E-02,0.10233E-02 
     & ,0.10471E-02,0.10715E-02,0.10965E-02,0.11220E-02,0.11481E-02,0.11749E-02,0.12023E-02 
     & ,0.12303E-02,0.12589E-02,0.12882E-02,0.13183E-02,0.13490E-02,0.13804E-02,0.14125E-02 
     & ,0.14454E-02,0.14791E-02,0.15136E-02,0.15488E-02,0.15849E-02,0.16218E-02,0.16596E-02 
     & ,0.16982E-02,0.16984E-02,0.17031E-02,0.17078E-02,0.17101E-02,0.17125E-02,0.17149E-02 
     & ,0.17160E-02,0.17172E-02,0.17184E-02,0.17191E-02,0.17196E-02,0.17201E-02,0.17206E-02 
     & ,0.17210E-02,0.17215E-02,0.17220E-02,0.17232E-02,0.17244E-02,0.17268E-02,0.17292E-02 
     & ,0.17316E-02,0.17340E-02,0.17365E-02,0.17378E-02,0.17389E-02,0.17413E-02,0.17426E-02 
     & ,0.17438E-02,0.17450E-02,0.17463E-02,0.17467E-02,0.17472E-02,0.17477E-02,0.17482E-02 
     & ,0.17487E-02,0.17492E-02,0.17497E-02,0.17502E-02,0.17507E-02,0.17512E-02,0.17517E-02 
     & ,0.17522E-02,0.17527E-02,0.17532E-02,0.17537E-02,0.17542E-02,0.17547E-02,0.17552E-02 
     & ,0.17556E-02,0.17561E-02,0.17574E-02,0.17586E-02,0.17611E-02,0.17636E-02,0.17662E-02 
     & ,0.17687E-02,0.17712E-02,0.17783E-02,0.18197E-02,0.18621E-02,0.19055E-02,0.19498E-02 
     & ,0.19953E-02,0.20417E-02,0.20893E-02,0.21380E-02,0.21878E-02,0.22140E-02,0.22180E-02 
     & ,0.22219E-02,0.22259E-02,0.22275E-02,0.22339E-02,0.22380E-02,0.22387E-02,0.22420E-02 
     & ,0.22461E-02,0.22502E-02,0.22543E-02,0.22584E-02,0.22625E-02,0.22666E-02,0.22708E-02 
     & ,0.22729E-02,0.22749E-02,0.22791E-02,0.22833E-02,0.22875E-02,0.22909E-02,0.22918E-02 
     & ,0.22996E-02,0.23003E-02,0.23024E-02,0.23045E-02,0.23054E-02,0.23063E-02,0.23071E-02 
     & ,0.23088E-02,0.23110E-02,0.23131E-02,0.23175E-02,0.23218E-02,0.23262E-02,0.23305E-02 
     & ,0.23349E-02,0.23393E-02,0.23442E-02,0.23482E-02,0.23616E-02,0.23843E-02,0.23988E-02 
     & ,0.24547E-02,0.25119E-02,0.25704E-02,0.26303E-02,0.26915E-02,0.27542E-02,0.28184E-02 
     & ,0.28840E-02,0.29512E-02,0.30199E-02,0.30903E-02,0.31623E-02,0.32359E-02,0.33113E-02 
     & ,0.33884E-02,0.34674E-02,0.35481E-02,0.36308E-02,0.37154E-02,0.38019E-02,0.38905E-02 
     & ,0.39811E-02,0.40518E-02,0.40738E-02,0.40784E-02,0.41054E-02,0.41328E-02,0.41466E-02 
     & ,0.41605E-02,0.41687E-02,0.41745E-02,0.41886E-02,0.42028E-02,0.42171E-02,0.42315E-02 
     & ,0.42460E-02,0.42533E-02,0.42577E-02,0.42606E-02,0.42658E-02,0.42680E-02,0.42753E-02 
     & ,0.42901E-02,0.43050E-02,0.43200E-02,0.43275E-02,0.43351E-02,0.43381E-02,0.43412E-02 
     & ,0.43442E-02,0.43473E-02,0.43503E-02,0.43580E-02,0.43652E-02,0.43656E-02,0.43733E-02 
     & ,0.43811E-02,0.43966E-02,0.44122E-02,0.44280E-02,0.44668E-02,0.45709E-02,0.46774E-02 
     & ,0.47863E-02,0.48978E-02,0.50119E-02,0.51286E-02,0.52481E-02,0.53703E-02,0.54954E-02 
     & ,0.56234E-02,0.57544E-02,0.58884E-02,0.60256E-02,0.61659E-02,0.63096E-02,0.64565E-02 
     & ,0.66069E-02,0.67608E-02,0.69183E-02,0.70795E-02,0.72444E-02,0.74131E-02,0.75858E-02 
     & ,0.77625E-02,0.79433E-02,0.79579E-02,0.79681E-02,0.79784E-02,0.81283E-02,0.83176E-02 
     & ,0.85114E-02,0.87096E-02,0.89125E-02,0.91201E-02,0.93325E-02,0.95499E-02,0.97724E-02 
     & ,0.10000E-01,0.10233E-01,0.10471E-01,0.10715E-01,0.10965E-01,0.11220E-01,0.11482E-01 
     & ,0.11697E-01,0.11719E-01,0.11741E-01,0.11749E-01,0.11763E-01,0.11808E-01,0.11922E-01 
     & ,0.12023E-01,0.12303E-01,0.12398E-01,0.12589E-01,0.12882E-01,0.13183E-01,0.13490E-01 
     & ,0.13804E-01,0.14125E-01,0.14454E-01,0.14791E-01,0.15136E-01,0.15488E-01,0.15849E-01 
     & ,0.16218E-01,0.16596E-01,0.16982E-01,0.17378E-01,0.17783E-01,0.18197E-01,0.18621E-01 
     & ,0.19055E-01,0.19498E-01,0.19953E-01,0.20417E-01,0.20893E-01,0.21380E-01,0.21878E-01 
     & ,0.22387E-01,0.22790E-01,0.22909E-01,0.23442E-01,0.23988E-01,0.24547E-01,0.25119E-01 
     & ,0.25704E-01,0.26303E-01,0.26915E-01,0.27542E-01,0.28184E-01,0.28840E-01,0.29512E-01 
     & ,0.30200E-01,0.30903E-01,0.31623E-01,0.32359E-01,0.33113E-01,0.33884E-01,0.34674E-01 
     & ,0.35481E-01,0.36308E-01,0.37153E-01,0.38019E-01,0.38905E-01,0.39811E-01,0.40738E-01 
     & ,0.41687E-01,0.42658E-01,0.43652E-01,0.44668E-01,0.45709E-01,0.46774E-01,0.47863E-01 
     & ,0.48810E-01,0.48978E-01,0.50119E-01,0.51286E-01,0.52481E-01,0.53703E-01,0.54954E-01 
     & ,0.56234E-01,0.57544E-01,0.58884E-01,0.60256E-01,0.61659E-01,0.63096E-01,0.64565E-01 
     & ,0.66069E-01,0.67608E-01,0.69183E-01,0.70795E-01,0.72444E-01,0.74131E-01,0.75858E-01 
     & ,0.77625E-01,0.79433E-01,0.81283E-01,0.83176E-01,0.85114E-01,0.87096E-01,0.89125E-01 
     & ,0.91200E-01,0.91201E-01,0.93325E-01,0.95499E-01,0.97724E-01,0.10000E+00,0.10233E+00 
     & ,0.10471E+00,0.10715E+00,0.10965E+00,0.11000E+00,0.11220E+00,0.11482E+00,0.11749E+00 
     & ,0.12023E+00,0.12150E+00,0.12303E+00,0.12589E+00,0.12882E+00,0.13183E+00,0.13490E+00 
     & ,0.13804E+00,0.14125E+00,0.14454E+00,0.14791E+00,0.15136E+00,0.15488E+00,0.15849E+00 
     & ,0.16218E+00,0.16596E+00,0.16982E+00,0.17378E+00,0.17783E+00,0.18197E+00,0.18621E+00 
     & ,0.19055E+00,0.19498E+00,0.19953E+00,0.20417E+00,0.20893E+00,0.21250E+00,0.21380E+00 
     & ,0.21500E+00,0.21750E+00,0.21878E+00,0.22000E+00,0.22250E+00,0.22387E+00,0.22909E+00 
     & ,0.23442E+00,0.23988E+00,0.24547E+00,0.25119E+00,0.25704E+00,0.26303E+00,0.26915E+00 
     & ,0.27542E+00,0.28184E+00,0.28840E+00,0.29512E+00,0.30200E+00,0.30903E+00,0.31623E+00 
     & ,0.32359E+00,0.33113E+00,0.33884E+00,0.34674E+00,0.35000E+00,0.35481E+00,0.35500E+00 
     & ,0.36308E+00,0.36350E+00,0.37154E+00,0.38019E+00,0.38904E+00,0.39811E+00,0.40738E+00 
     & ,0.41000E+00,0.41687E+00,0.42658E+00,0.43652E+00,0.44050E+00,0.44668E+00,0.45709E+00 
     & ,0.46774E+00,0.46850E+00,0.47000E+00,0.47863E+00,0.48610E+00,0.48978E+00,0.50119E+00 
     & ,0.51286E+00,0.52481E+00,0.53703E+00,0.54700E+00,0.54954E+00,0.55500E+00,0.56234E+00 
     & ,0.57544E+00,0.58884E+00,0.60256E+00,0.61650E+00,0.61660E+00,0.63096E+00,0.64150E+00 
     & ,0.64565E+00,0.64920E+00,0.65620E+00,0.66069E+00,0.67608E+00,0.69183E+00,0.70795E+00 
     & ,0.72444E+00,0.74131E+00,0.74800E+00,0.75858E+00,0.77625E+00,0.79433E+00,0.80200E+00 
     & ,0.81283E+00,0.83176E+00,0.85114E+00,0.86550E+00,0.87096E+00,0.89125E+00,0.89300E+00 
     & ,0.91201E+00,0.93325E+00,0.95499E+00,0.97724E+00,0.10000E+01,0.10233E+01,0.10471E+01 
     & ,0.10715E+01,0.10965E+01,0.11220E+01,0.11482E+01,0.11749E+01,0.12023E+01,0.12200E+01 
     & ,0.12303E+01,0.12589E+01,0.12818E+01,0.12882E+01,0.13183E+01,0.13490E+01,0.13804E+01 
     & ,0.14125E+01,0.14454E+01,0.14791E+01,0.15136E+01,0.15488E+01,0.15849E+01,0.16218E+01 
     & ,0.16300E+01,0.16596E+01,0.16982E+01,0.17378E+01,0.17783E+01,0.18197E+01,0.18621E+01 
     & ,0.18750E+01,0.19055E+01,0.19498E+01,0.19953E+01,0.20417E+01,0.20893E+01,0.21218E+01 
     & ,0.21380E+01,0.21656E+01,0.21878E+01,0.21900E+01,0.22387E+01,0.22909E+01,0.23442E+01 
     & ,0.23988E+01,0.24547E+01,0.25119E+01,0.25704E+01,0.26252E+01,0.26303E+01,0.26915E+01 
     & ,0.27542E+01,0.28184E+01,0.28840E+01,0.29512E+01,0.30200E+01,0.30903E+01,0.31623E+01 
     & ,0.32359E+01,0.33113E+01,0.33884E+01,0.34500E+01,0.34674E+01,0.35481E+01,0.36308E+01 
     & ,0.37153E+01,0.38000E+01,0.38019E+01,0.38904E+01,0.39811E+01,0.40512E+01,0.40738E+01 
     & ,0.41687E+01,0.42658E+01,0.43652E+01,0.44668E+01,0.45709E+01,0.46773E+01,0.47500E+01 
     & ,0.47863E+01,0.48978E+01,0.50119E+01,0.51286E+01,0.52481E+01,0.53703E+01,0.54954E+01 
     & ,0.56234E+01,0.57544E+01,0.58884E+01,0.60256E+01,0.61659E+01,0.62500E+01,0.63096E+01 
     & ,0.64565E+01,0.66069E+01,0.67608E+01,0.69183E+01,0.70795E+01,0.72444E+01,0.74131E+01 
     & ,0.75858E+01,0.76200E+01,0.77625E+01,0.79433E+01,0.81283E+01,0.83176E+01,0.85114E+01 
     & ,0.87096E+01,0.89125E+01,0.91201E+01,0.93325E+01,0.94000E+01,0.95000E+01,0.95499E+01 
     & ,0.96000E+01,0.97000E+01,0.97724E+01,0.98000E+01,0.99000E+01,0.10000E+02,0.10233E+02 
     & ,0.10360E+02,0.10471E+02,0.10715E+02,0.10965E+02,0.11220E+02,0.11300E+02,0.11482E+02 
     & ,0.11749E+02,0.12023E+02,0.12303E+02,0.12589E+02,0.12883E+02,0.13183E+02,0.13490E+02 
     & ,0.13804E+02,0.14125E+02,0.14454E+02,0.14791E+02,0.15136E+02,0.15488E+02,0.15849E+02 
     & ,0.16218E+02,0.16596E+02,0.16982E+02,0.17378E+02,0.17783E+02,0.18197E+02,0.18621E+02 
     & ,0.19055E+02,0.19498E+02,0.19953E+02,0.20417E+02,0.20893E+02,0.21380E+02,0.21878E+02 
     & ,0.22387E+02,0.22909E+02,0.23442E+02,0.23988E+02,0.24547E+02,0.25119E+02,0.25704E+02 
     & ,0.26303E+02,0.26915E+02,0.27542E+02,0.28184E+02,0.28840E+02,0.29512E+02,0.30200E+02 
     & ,0.30903E+02,0.31623E+02,0.32359E+02,0.33113E+02,0.33884E+02,0.34674E+02,0.35481E+02 
     & ,0.36308E+02,0.37154E+02,0.38019E+02,0.38904E+02,0.39811E+02,0.40738E+02,0.41687E+02 
     & ,0.42658E+02,0.43652E+02,0.44668E+02,0.45709E+02,0.46773E+02,0.47863E+02,0.48978E+02 
     & ,0.50119E+02,0.51286E+02,0.52481E+02,0.53703E+02,0.54954E+02,0.56234E+02,0.57544E+02 
     & ,0.58884E+02,0.60256E+02,0.61660E+02,0.63096E+02,0.64565E+02,0.66069E+02,0.67608E+02 
     & ,0.69183E+02,0.70795E+02,0.72444E+02,0.74131E+02,0.75858E+02,0.77625E+02,0.79433E+02 
     & ,0.81283E+02,0.83176E+02,0.85114E+02,0.87096E+02,0.89125E+02,0.91201E+02,0.93325E+02 
     & ,0.95499E+02,0.97724E+02,0.10000E+03,0.10233E+03,0.10471E+03,0.10715E+03,0.10965E+03 
     & ,0.11220E+03,0.11481E+03,0.11749E+03,0.12023E+03,0.12303E+03,0.12589E+03,0.12882E+03 
     & ,0.13183E+03,0.13490E+03,0.13804E+03,0.14125E+03,0.14454E+03,0.14791E+03,0.15136E+03 
     & ,0.15488E+03,0.15849E+03,0.16218E+03,0.16596E+03,0.16982E+03,0.17378E+03,0.17783E+03 
     & ,0.18197E+03,0.18621E+03,0.19055E+03,0.19498E+03,0.19953E+03,0.20417E+03,0.20893E+03 
     & ,0.21380E+03,0.21878E+03,0.22387E+03,0.22909E+03,0.23442E+03,0.23988E+03,0.24547E+03 
     & ,0.25119E+03,0.25704E+03,0.26303E+03,0.26915E+03,0.27542E+03,0.28184E+03,0.28840E+03 
     & ,0.29512E+03,0.30200E+03,0.30903E+03,0.31623E+03,0.32359E+03,0.33113E+03,0.33884E+03 
     & ,0.34674E+03,0.35481E+03,0.36308E+03,0.37154E+03,0.38019E+03,0.38905E+03,0.39811E+03 
     & ,0.40738E+03,0.41687E+03,0.42658E+03,0.43652E+03,0.44668E+03,0.45709E+03,0.46774E+03 
     & ,0.47863E+03,0.48978E+03,0.50119E+03,0.51286E+03,0.52481E+03,0.53703E+03,0.54954E+03 
     & ,0.56234E+03,0.57544E+03,0.58884E+03,0.60256E+03,0.61660E+03,0.63096E+03,0.64565E+03 
     & ,0.66069E+03,0.67608E+03,0.69183E+03,0.70795E+03,0.72444E+03,0.74131E+03,0.75858E+03 
     & ,0.77625E+03,0.79433E+03,0.81283E+03,0.83176E+03,0.85114E+03,0.87096E+03,0.89125E+03 
     & ,0.91201E+03,0.93325E+03,0.95499E+03,0.97724E+03,0.10000E+04,0.10233E+04,0.10471E+04 
     & ,0.10715E+04,0.10965E+04,0.11220E+04,0.11482E+04,0.11749E+04,0.12023E+04,0.12303E+04 
     & ,0.12589E+04,0.12882E+04,0.13183E+04,0.13490E+04,0.13804E+04,0.14125E+04,0.14454E+04 
     & ,0.14791E+04,0.15136E+04,0.15488E+04,0.15849E+04,0.16218E+04,0.16596E+04,0.16982E+04 
     & ,0.17378E+04,0.17783E+04,0.18197E+04,0.18621E+04,0.19055E+04,0.19498E+04,0.19953E+04 
     & ,0.20417E+04,0.20893E+04,0.21380E+04,0.21878E+04,0.22387E+04,0.22909E+04,0.23442E+04 
     & ,0.23988E+04,0.24547E+04,0.25119E+04,0.25704E+04,0.26303E+04,0.26915E+04,0.27542E+04 
     & ,0.28184E+04,0.28840E+04,0.29512E+04,0.30199E+04,0.30903E+04,0.31623E+04,0.32359E+04 
     & ,0.33113E+04,0.33884E+04,0.34674E+04,0.35481E+04,0.36308E+04,0.37153E+04,0.38019E+04 
     & ,0.38904E+04,0.39811E+04,0.40738E+04,0.41687E+04,0.42658E+04,0.43652E+04,0.44668E+04 
     & ,0.45709E+04,0.46774E+04,0.47863E+04,0.48978E+04,0.50119E+04,0.51286E+04,0.52481E+04 
     & ,0.53703E+04,0.54954E+04,0.56234E+04,0.57544E+04,0.58884E+04,0.60256E+04,0.61659E+04 
     & ,0.63096E+04,0.64565E+04,0.66069E+04,0.67608E+04,0.69183E+04,0.70795E+04,0.72444E+04 
     & ,0.74131E+04,0.75858E+04,0.77625E+04,0.79433E+04,0.81283E+04,0.83176E+04,0.85114E+04 
     & ,0.87096E+04,0.89125E+04,0.91201E+04,0.93325E+04,0.95499E+04,0.97724E+04,0.10000E+05/
 
	data (Kextism(i),i=1, 1064) / 
     & 0.13640E-23,0.14360E-23,0.15140E-23,0.16020E-23,0.16810E-23,0.17710E-23,0.18680E-23 
     & ,0.19700E-23,0.20840E-23,0.21990E-23,0.23130E-23,0.24330E-23,0.25510E-23,0.26910E-23 
     & ,0.28360E-23,0.29950E-23,0.31610E-23,0.33130E-23,0.34990E-23,0.36760E-23,0.38700E-23 
     & ,0.40690E-23,0.42840E-23,0.44930E-23,0.45620E-23,0.46950E-23,0.47740E-23,0.47820E-23 
     & ,0.48770E-23,0.49140E-23,0.50030E-23,0.51160E-23,0.52400E-23,0.53870E-23,0.55100E-23 
     & ,0.55470E-23,0.54070E-23,0.52020E-23,0.49690E-23,0.47590E-23,0.45080E-23,0.42820E-23 
     & ,0.35570E-23,0.29770E-23,0.29730E-23,0.32340E-23,0.34250E-23,0.36220E-23,0.38340E-23 
     & ,0.40560E-23,0.42760E-23,0.44980E-23,0.47330E-23,0.49960E-23,0.52710E-23,0.55470E-23 
     & ,0.58340E-23,0.61370E-23,0.64590E-23,0.67900E-23,0.71290E-23,0.74990E-23,0.79160E-23 
     & ,0.83510E-23,0.87890E-23,0.92530E-23,0.97480E-23,0.10280E-22,0.10840E-22,0.11420E-22 
     & ,0.12000E-22,0.12630E-22,0.13330E-22,0.14060E-22,0.14840E-22,0.15630E-22,0.16500E-22 
     & ,0.17400E-22,0.18330E-22,0.19270E-22,0.20210E-22,0.21160E-22,0.22170E-22,0.23360E-22 
     & ,0.24570E-22,0.25810E-22,0.27130E-22,0.28520E-22,0.29960E-22,0.31430E-22,0.33010E-22 
     & ,0.34720E-22,0.36470E-22,0.38310E-22,0.40230E-22,0.42200E-22,0.44250E-22,0.46350E-22 
     & ,0.48470E-22,0.50590E-22,0.52860E-22,0.55200E-22,0.58130E-22,0.59190E-22,0.60770E-22 
     & ,0.61860E-22,0.60580E-22,0.59470E-22,0.59960E-22,0.61830E-22,0.62110E-22,0.60610E-22 
     & ,0.59840E-22,0.60190E-22,0.61200E-22,0.62410E-22,0.65990E-22,0.68030E-22,0.70120E-22 
     & ,0.70710E-22,0.70830E-22,0.70080E-22,0.68220E-22,0.65370E-22,0.57840E-22,0.51170E-22 
     & ,0.51170E-22,0.51230E-22,0.51720E-22,0.51770E-22,0.52160E-22,0.56620E-22,0.59830E-22 
     & ,0.63030E-22,0.66220E-22,0.69500E-22,0.72830E-22,0.76300E-22,0.79830E-22,0.83430E-22 
     & ,0.87150E-22,0.90950E-22,0.94830E-22,0.98840E-22,0.10840E-21,0.10710E-21,0.10420E-21 
     & ,0.10630E-21,0.10400E-21,0.10600E-21,0.10870E-21,0.10950E-21,0.10860E-21,0.10630E-21 
     & ,0.10550E-21,0.10630E-21,0.10750E-21,0.10980E-21,0.11590E-21,0.11860E-21,0.11970E-21 
     & ,0.11990E-21,0.11950E-21,0.11810E-21,0.11100E-21,0.99630E-22,0.94360E-22,0.92310E-22 
     & ,0.92480E-22,0.93420E-22,0.93680E-22,0.95220E-22,0.10220E-21,0.10830E-21,0.11350E-21 
     & ,0.11860E-21,0.12380E-21,0.12920E-21,0.13460E-21,0.14020E-21,0.14580E-21,0.15150E-21 
     & ,0.15710E-21,0.16290E-21,0.16870E-21,0.17430E-21,0.18030E-21,0.18610E-21,0.19140E-21 
     & ,0.19850E-21,0.19910E-21,0.20600E-21,0.21190E-21,0.21610E-21,0.22090E-21,0.22550E-21 
     & ,0.23100E-21,0.23100E-21,0.23220E-21,0.23480E-21,0.23840E-21,0.24450E-21,0.24660E-21 
     & ,0.24810E-21,0.25370E-21,0.26080E-21,0.26430E-21,0.26560E-21,0.26500E-21,0.26200E-21 
     & ,0.25810E-21,0.25160E-21,0.24380E-21,0.22540E-21,0.21360E-21,0.21280E-21,0.21810E-21 
     & ,0.22190E-21,0.22530E-21,0.22960E-21,0.23300E-21,0.23660E-21,0.25270E-21,0.26440E-21 
     & ,0.27290E-21,0.27650E-21,0.27970E-21,0.28260E-21,0.28800E-21,0.29530E-21,0.30460E-21 
     & ,0.31550E-21,0.32580E-21,0.33410E-21,0.34030E-21,0.34410E-21,0.34400E-21,0.33920E-21 
     & ,0.32910E-21,0.31360E-21,0.29260E-21,0.27050E-21,0.24580E-21,0.22180E-21,0.20050E-21 
     & ,0.18640E-21,0.17260E-21,0.15940E-21,0.16210E-21,0.17250E-21,0.17920E-21,0.18410E-21 
     & ,0.18780E-21,0.19070E-21,0.19700E-21,0.21570E-21,0.22750E-21,0.23760E-21,0.24670E-21 
     & ,0.25530E-21,0.26360E-21,0.27160E-21,0.27980E-21,0.29350E-21,0.31240E-21,0.31710E-21 
     & ,0.32070E-21,0.32010E-21,0.31820E-21,0.30790E-21,0.30660E-21,0.30620E-21,0.30290E-21 
     & ,0.29230E-21,0.29140E-21,0.29810E-21,0.30450E-21,0.31360E-21,0.31790E-21,0.32090E-21 
     & ,0.31880E-21,0.31060E-21,0.29760E-21,0.29430E-21,0.29960E-21,0.30450E-21,0.30630E-21 
     & ,0.34930E-21,0.35450E-21,0.36500E-21,0.37380E-21,0.37210E-21,0.36860E-21,0.35920E-21 
     & ,0.31970E-21,0.25030E-21,0.22040E-21,0.19480E-21,0.19540E-21,0.20200E-21,0.20430E-21 
     & ,0.20970E-21,0.21420E-21,0.21590E-21,0.21290E-21,0.22570E-21,0.23970E-21,0.24570E-21 
     & ,0.26630E-21,0.28300E-21,0.29710E-21,0.31020E-21,0.32270E-21,0.33480E-21,0.34660E-21 
     & ,0.35820E-21,0.36950E-21,0.38060E-21,0.39140E-21,0.40230E-21,0.41300E-21,0.42360E-21 
     & ,0.43410E-21,0.44440E-21,0.45450E-21,0.46460E-21,0.47410E-21,0.48400E-21,0.49900E-21 
     & ,0.52840E-21,0.52730E-21,0.52460E-21,0.52410E-21,0.51170E-21,0.51150E-21,0.51940E-21 
     & ,0.52490E-21,0.52780E-21,0.53090E-21,0.54660E-21,0.55110E-21,0.55470E-21,0.55690E-21 
     & ,0.55410E-21,0.53690E-21,0.50030E-21,0.48550E-21,0.48620E-21,0.48740E-21,0.49370E-21 
     & ,0.51200E-21,0.52320E-21,0.53740E-21,0.56160E-21,0.60400E-21,0.65450E-21,0.68420E-21 
     & ,0.69810E-21,0.68500E-21,0.66490E-21,0.59050E-21,0.50330E-21,0.49920E-21,0.45370E-21 
     & ,0.42870E-21,0.40240E-21,0.39370E-21,0.39050E-21,0.39390E-21,0.41480E-21,0.43310E-21 
     & ,0.44940E-21,0.46300E-21,0.47580E-21,0.48770E-21,0.49850E-21,0.50860E-21,0.51830E-21 
     & ,0.52760E-21,0.53680E-21,0.54580E-21,0.55440E-21,0.56270E-21,0.57090E-21,0.57910E-21 
     & ,0.58710E-21,0.59530E-21,0.60370E-21,0.61210E-21,0.61800E-21,0.62560E-21,0.63360E-21 
     & ,0.63980E-21,0.65160E-21,0.65130E-21,0.65060E-21,0.64910E-21,0.64670E-21,0.65580E-21 
     & ,0.66330E-21,0.67110E-21,0.67900E-21,0.68750E-21,0.69760E-21,0.70930E-21,0.72420E-21 
     & ,0.72830E-21,0.72590E-21,0.72950E-21,0.75030E-21,0.75640E-21,0.75120E-21,0.77260E-21 
     & ,0.82070E-21,0.82020E-21,0.81810E-21,0.81380E-21,0.80620E-21,0.78080E-21,0.71540E-21 
     & ,0.70770E-21,0.72150E-21,0.72380E-21,0.73280E-21,0.74160E-21,0.75730E-21,0.75390E-21 
     & ,0.76450E-21,0.77480E-21,0.78470E-21,0.79360E-21,0.80280E-21,0.81170E-21,0.82040E-21 
     & ,0.82900E-21,0.83900E-21,0.84790E-21,0.85510E-21,0.86290E-21,0.86760E-21,0.88160E-21 
     & ,0.89630E-21,0.90950E-21,0.91760E-21,0.91670E-21,0.92480E-21,0.93830E-21,0.95840E-21 
     & ,0.99820E-21,0.10100E-20,0.99960E-21,0.94710E-21,0.94960E-21,0.96390E-21,0.97900E-21 
     & ,0.99410E-21,0.10100E-20,0.10260E-20,0.10400E-20,0.10560E-20,0.10730E-20,0.10910E-20 
     & ,0.11090E-20,0.11270E-20,0.11460E-20,0.11650E-20,0.11840E-20,0.12040E-20,0.12010E-20 
     & ,0.11730E-20,0.11880E-20,0.12050E-20,0.12220E-20,0.12390E-20,0.12590E-20,0.12800E-20 
     & ,0.13040E-20,0.13350E-20,0.13770E-20,0.14170E-20,0.14520E-20,0.14940E-20,0.15380E-20 
     & ,0.15730E-20,0.15790E-20,0.16230E-20,0.16690E-20,0.17170E-20,0.17690E-20,0.18260E-20 
     & ,0.18870E-20,0.19510E-20,0.21370E-20,0.23100E-20,0.24830E-20,0.26540E-20,0.28240E-20 
     & ,0.29930E-20,0.31540E-20,0.33240E-20,0.34560E-20,0.34940E-20,0.34170E-20,0.32600E-20 
     & ,0.30770E-20,0.28970E-20,0.27430E-20,0.26150E-20,0.25130E-20,0.24300E-20,0.23670E-20 
     & ,0.23290E-20,0.23290E-20,0.22790E-20,0.22280E-20,0.21720E-20,0.21150E-20,0.20540E-20 
     & ,0.19850E-20,0.19160E-20,0.18490E-20,0.18400E-20,0.17890E-20,0.17320E-20,0.16790E-20 
     & ,0.16290E-20,0.16070E-20,0.15820E-20,0.15360E-20,0.14930E-20,0.14500E-20,0.14150E-20 
     & ,0.13830E-20,0.13550E-20,0.13280E-20,0.13000E-20,0.12750E-20,0.12520E-20,0.12330E-20 
     & ,0.12190E-20,0.12100E-20,0.12080E-20,0.12100E-20,0.12180E-20,0.12330E-20,0.12550E-20 
     & ,0.12870E-20,0.13300E-20,0.13840E-20,0.14470E-20,0.15070E-20,0.15410E-20,0.15490E-20 
     & ,0.15540E-20,0.15570E-20,0.15530E-20,0.15460E-20,0.15250E-20,0.15100E-20,0.14390E-20 
     & ,0.13600E-20,0.12840E-20,0.12100E-20,0.11610E-20,0.11140E-20,0.10770E-20,0.10440E-20 
     & ,0.10150E-20,0.99150E-21,0.97050E-21,0.95180E-21,0.93470E-21,0.91530E-21,0.89600E-21 
     & ,0.87700E-21,0.85840E-21,0.84010E-21,0.82200E-21,0.81470E-21,0.80410E-21,0.80370E-21 
     & ,0.78630E-21,0.78540E-21,0.76860E-21,0.75110E-21,0.73380E-21,0.71650E-21,0.69930E-21 
     & ,0.69450E-21,0.68220E-21,0.66510E-21,0.64820E-21,0.64150E-21,0.63140E-21,0.61460E-21 
     & ,0.59800E-21,0.59680E-21,0.59450E-21,0.58140E-21,0.57040E-21,0.56500E-21,0.54880E-21 
     & ,0.53290E-21,0.51720E-21,0.50180E-21,0.48960E-21,0.48660E-21,0.48020E-21,0.47170E-21 
     & ,0.45720E-21,0.44290E-21,0.42900E-21,0.41550E-21,0.41540E-21,0.40210E-21,0.39270E-21 
     & ,0.38910E-21,0.38600E-21,0.38010E-21,0.37640E-21,0.36400E-21,0.35200E-21,0.34030E-21 
     & ,0.32890E-21,0.31780E-21,0.31360E-21,0.30700E-21,0.29660E-21,0.28640E-21,0.28230E-21 
     & ,0.27650E-21,0.26690E-21,0.25760E-21,0.25100E-21,0.24850E-21,0.23980E-21,0.23900E-21 
     & ,0.23120E-21,0.22290E-21,0.21490E-21,0.20710E-21,0.19950E-21,0.19220E-21,0.18520E-21 
     & ,0.17850E-21,0.17200E-21,0.16580E-21,0.15980E-21,0.15400E-21,0.14850E-21,0.14510E-21 
     & ,0.14320E-21,0.13810E-21,0.13420E-21,0.13320E-21,0.12840E-21,0.12390E-21,0.11950E-21 
     & ,0.11520E-21,0.11100E-21,0.10700E-21,0.10320E-21,0.99460E-22,0.95840E-22,0.92340E-22 
     & ,0.91590E-22,0.88940E-22,0.85650E-22,0.82470E-22,0.79390E-22,0.76400E-22,0.73510E-22 
     & ,0.72670E-22,0.70720E-22,0.68020E-22,0.65400E-22,0.62870E-22,0.60420E-22,0.58830E-22 
     & ,0.58050E-22,0.56760E-22,0.55760E-22,0.55660E-22,0.53530E-22,0.51390E-22,0.49320E-22 
     & ,0.47320E-22,0.45380E-22,0.43520E-22,0.41710E-22,0.40120E-22,0.39970E-22,0.38300E-22 
     & ,0.36680E-22,0.35130E-22,0.33630E-22,0.32190E-22,0.30800E-22,0.29470E-22,0.28210E-22 
     & ,0.27010E-22,0.26060E-22,0.24700E-22,0.23840E-22,0.23610E-22,0.22570E-22,0.21580E-22 
     & ,0.20630E-22,0.19750E-22,0.19730E-22,0.18860E-22,0.18040E-22,0.17440E-22,0.17250E-22 
     & ,0.16500E-22,0.15780E-22,0.15090E-22,0.14440E-22,0.13830E-22,0.13250E-22,0.12880E-22 
     & ,0.12700E-22,0.12180E-22,0.11700E-22,0.11240E-22,0.10820E-22,0.10420E-22,0.10070E-22 
     & ,0.97470E-23,0.94770E-23,0.92910E-23,0.93120E-23,0.97100E-23,0.95130E-23,0.91270E-23 
     & ,0.84370E-23,0.80700E-23,0.78250E-23,0.76580E-23,0.76020E-23,0.77570E-23,0.83380E-23 
     & ,0.95730E-23,0.98790E-23,0.11150E-22,0.13070E-22,0.16100E-22,0.20050E-22,0.23520E-22 
     & ,0.26810E-22,0.31200E-22,0.36420E-22,0.40090E-22,0.40590E-22,0.40730E-22,0.40570E-22 
     & ,0.40290E-22,0.39440E-22,0.38740E-22,0.38480E-22,0.37560E-22,0.36720E-22,0.34950E-22 
     & ,0.33720E-22,0.32310E-22,0.28830E-22,0.26030E-22,0.23820E-22,0.23160E-22,0.21570E-22 
     & ,0.19410E-22,0.17400E-22,0.15610E-22,0.14100E-22,0.12630E-22,0.11400E-22,0.10330E-22 
     & ,0.95040E-23,0.91500E-23,0.92620E-23,0.96810E-23,0.10180E-22,0.10770E-22,0.11430E-22 
     & ,0.12170E-22,0.12860E-22,0.13450E-22,0.13970E-22,0.14370E-22,0.14690E-22,0.14490E-22 
     & ,0.14180E-22,0.13700E-22,0.13090E-22,0.12470E-22,0.12040E-22,0.11570E-22,0.11030E-22 
     & ,0.10560E-22,0.10150E-22,0.98100E-23,0.94610E-23,0.91740E-23,0.89030E-23,0.86560E-23 
     & ,0.84340E-23,0.82350E-23,0.80540E-23,0.78870E-23,0.77270E-23,0.75680E-23,0.74030E-23 
     & ,0.72230E-23,0.70280E-23,0.68160E-23,0.65840E-23,0.63380E-23,0.60800E-23,0.58120E-23 
     & ,0.55380E-23,0.52630E-23,0.49890E-23,0.47190E-23,0.44570E-23,0.42060E-23,0.39670E-23 
     & ,0.37410E-23,0.35280E-23,0.33280E-23,0.31410E-23,0.29650E-23,0.28010E-23,0.26460E-23 
     & ,0.25020E-23,0.23650E-23,0.22380E-23,0.21170E-23,0.20030E-23,0.18960E-23,0.17950E-23 
     & ,0.17000E-23,0.16100E-23,0.15250E-23,0.14450E-23,0.13690E-23,0.12980E-23,0.12300E-23 
     & ,0.11660E-23,0.11050E-23,0.10480E-23,0.99430E-24,0.94310E-24,0.89450E-24,0.84880E-24 
     & ,0.80540E-24,0.76430E-24,0.72560E-24,0.68890E-24,0.65420E-24,0.62170E-24,0.59080E-24 
     & ,0.56150E-24,0.53380E-24,0.50760E-24,0.48280E-24,0.45940E-24,0.43730E-24,0.41650E-24 
     & ,0.39690E-24,0.37840E-24,0.36110E-24,0.34500E-24,0.33000E-24,0.31620E-24,0.30350E-24 
     & ,0.29170E-24,0.28020E-24,0.26790E-24,0.25440E-24,0.24080E-24,0.22780E-24,0.21590E-24 
     & ,0.20480E-24,0.19460E-24,0.18500E-24,0.17600E-24,0.16760E-24,0.15960E-24,0.15210E-24 
     & ,0.14490E-24,0.13810E-24,0.13170E-24,0.12560E-24,0.11970E-24,0.11420E-24,0.10890E-24 
     & ,0.10390E-24,0.99090E-25,0.94530E-25,0.90200E-25,0.86080E-25,0.82160E-25,0.78290E-25 
     & ,0.74460E-25,0.70630E-25,0.66990E-25,0.63540E-25,0.60300E-25,0.57260E-25,0.54390E-25 
     & ,0.51680E-25,0.49130E-25,0.46710E-25,0.44440E-25,0.42280E-25,0.40250E-25,0.38330E-25 
     & ,0.36520E-25,0.34800E-25,0.33180E-25,0.31640E-25,0.30180E-25,0.28810E-25,0.27500E-25 
     & ,0.26270E-25,0.25100E-25,0.23990E-25,0.22940E-25,0.21940E-25,0.20990E-25,0.20090E-25 
     & ,0.19240E-25,0.18420E-25,0.17650E-25,0.16920E-25,0.16220E-25,0.15550E-25,0.14920E-25 
     & ,0.14320E-25,0.13740E-25,0.13200E-25,0.12680E-25,0.12180E-25,0.11710E-25,0.11250E-25 
     & ,0.10820E-25,0.10410E-25,0.10020E-25,0.96410E-26,0.92820E-26,0.89380E-26,0.86080E-26 
     & ,0.82920E-26,0.79870E-26,0.76930E-26,0.74110E-26,0.71380E-26,0.68760E-26,0.66230E-26 
     & ,0.63790E-26,0.61430E-26,0.59170E-26,0.56990E-26,0.54890E-26,0.52860E-26,0.50920E-26 
     & ,0.49050E-26,0.47240E-26,0.45510E-26,0.43840E-26,0.42230E-26,0.40680E-26,0.39180E-26 
     & ,0.37740E-26,0.36350E-26,0.35010E-26,0.33730E-26,0.32490E-26,0.31290E-26,0.30140E-26 
     & ,0.29020E-26,0.27950E-26,0.26920E-26,0.25930E-26,0.24980E-26,0.24050E-26,0.23170E-26 
     & ,0.22310E-26,0.21490E-26,0.20690E-26,0.19930E-26,0.19190E-26,0.18480E-26,0.17800E-26 
     & ,0.17140E-26,0.16510E-26,0.15900E-26,0.15310E-26,0.14740E-26,0.14190E-26,0.13670E-26 
     & ,0.13160E-26,0.12670E-26,0.12200E-26,0.11750E-26,0.11310E-26,0.10890E-26,0.10480E-26 
     & ,0.10090E-26,0.97120E-27,0.93490E-27,0.90000E-27,0.86630E-27,0.83390E-27,0.80270E-27 
     & ,0.77270E-27,0.74370E-27,0.71590E-27,0.68900E-27,0.66320E-27,0.63840E-27,0.61440E-27 
     & ,0.59140E-27,0.56930E-27,0.54790E-27,0.52730E-27,0.50750E-27,0.48840E-27,0.47000E-27 
     & ,0.45240E-27,0.43540E-27,0.41900E-27,0.40330E-27,0.38810E-27,0.37350E-27,0.35950E-27 
     & ,0.34600E-27,0.33290E-27,0.32040E-27,0.30840E-27,0.29680E-27,0.28560E-27,0.27490E-27 
     & ,0.26460E-27,0.25460E-27,0.24500E-27,0.23580E-27,0.22690E-27,0.21840E-27,0.21020E-27 
     & ,0.20230E-27,0.19470E-27,0.18740E-27,0.18030E-27,0.17350E-27,0.16700E-27,0.16070E-27 
     & ,0.15470E-27,0.14880E-27,0.14320E-27,0.13770E-27,0.13250E-27,0.12740E-27,0.12250E-27/
 
	end module ISMExtinction


	real*8 function Reddening(lam,dlam,Av)
	use ISMExtinction
	IMPLICIT NONE
	integer j
	real*8 lam,Av,dlam,l1,l2
	real*8 Kext,scale,KextV,n,dlamism

	KextV=0d0
	n=0d0
	do i=1,NLAMISM
		if(lamism(i).gt.(0.92*0.55).and.lamism(i).lt.(1.08*0.55)) then
			if(i.eq.1) then
				dlamism=lamism(i+1)-lamism(i)
			else if(i.eq.NLAMISM) then
				dlamism=lamism(i)-lamism(i-1)
			else
				dlamism=(lamism(i+1)-lamism(i-1))/2d0
			endif
			KextV=KextV+KextISM(i)*dlamism
			n=n+dlamism
		endif
	enddo
	KextV=KextV/n
	scale=Av/(2.5d0*log10(exp(1d0))*KextV)

	l1=lam-dlam/2d0
	l2=lam+dlam/2d0

	Kext=0d0
	n=0
	do j=1,NLAMISM
		if(lamism(j).ge.l1.and.lamism(j).le.l2) then
			if(j.eq.1) then
				dlamism=lamism(j+1)-lamism(j)
			else if(j.eq.NLAMISM) then
				dlamism=lamism(j)-lamism(j-1)
			else
				dlamism=(lamism(j+1)-lamism(j-1))/2d0
			endif
			Kext=Kext+KextISM(j)*dlamism
			n=n+dlamism
		endif
	enddo
	if(n.gt.0) then
		Kext=Kext/n
		Reddening=exp(-scale*Kext)
		return
	else
		do j=1,NLAMISM-1
			if(lamism(j).le.lam.and.lamism(j+1).ge.lam) then
				Kext=KextISM(j)+(KextISM(j+1)-KextISM(j))*(lam-lamism(j))/(lamism(j+1)-lamism(j))
				Reddening=exp(-scale*Kext)
				return
			endif
		enddo
	endif

	return
	end

	real*8 function compute_dlam(lam0)
	use Parameters
	IMPLICIT NONE
	real*8 lam0
	integer i
	
	do i=1,nlam-1
		if(lam(i).le.lam0.and.lam(i+1).ge.lam0) then
			if(i.eq.1) then
				compute_dlam=lam(i+1)-lam(i)
				return
			else
				compute_dlam=(lam(i+1)-lam(i-1))/2d0
				return
			endif
		endif
	enddo
	
	return
	end
	